<form
  [formGroup]="form"
  (ngSubmit)="onSubmit()"
  class="flex flex-col gap-4 p-fluid"
>
  <div class="field">
    <label
      for="title"
      class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"
      >Title</label
    >
    <input
      id="title"
      type="text"
      pInputText
      formControlName="title"
      placeholder="What needs to be done?"
    />
    <small
      class="text-red-500"
      *ngIf="form.get('title')?.invalid && form.get('title')?.touched"
    >
      Title is required (max 100 chars).
    </small>
  </div>

  <div class="field">
    <label
      for="description"
      class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"
      >Description</label
    >
    <textarea
      id="description"
      pInputTextarea
      formControlName="description"
      rows="3"
      placeholder="Add more details..."
    ></textarea>
  </div>

  <div class="grid grid-cols-2 gap-4">
    <div class="field">
      <label
        for="priority"
        class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"
        >Priority</label
      >
      <p-dropdown
        id="priority"
        [options]="priorities"
        formControlName="priority"
        placeholder="Select Priority"
      ></p-dropdown>
    </div>
    <div class="field">
      <label
        for="status"
        class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"
        >Status</label
      >
      <p-dropdown
        id="status"
        [options]="statuses"
        formControlName="status"
        placeholder="Select Status"
      ></p-dropdown>
    </div>
  </div>

  <div class="grid grid-cols-2 gap-4">
    <div class="field">
      <label
        for="dueDate"
        class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"
        >Due Date</label
      >
      <p-calendar
        id="dueDate"
        formControlName="dueDate"
        [showIcon]="true"
        appendTo="body"
      ></p-calendar>
    </div>
    <div class="field">
      <label
        for="assignedUserId"
        class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"
        >Assignee</label
      >
      <p-dropdown
        id="assignedUserId"
        [options]="users"
        optionLabel="name"
        optionValue="id"
        formControlName="assignedUserId"
        placeholder="Assign to..."
        [showClear]="true"
      ></p-dropdown>
    </div>
  </div>

  <div class="flex justify-end gap-2 mt-6">
    <button
      pButton
      label="Cancel"
      type="button"
      class="p-button-text p-button-secondary"
      (click)="cancel.emit()"
    ></button>
    <button
      pButton
      [label]="task ? 'Update Task' : 'Create Task'"
      type="submit"
      [disabled]="form.invalid"
    ></button>
  </div>
</form>
